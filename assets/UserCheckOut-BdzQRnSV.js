import{_ as A,m as q,h as p,S as U,i as P,r as f,o as m,c as u,b as t,a as e,F as v,j as N,t as h,k as b,w as x,d as T,e as d,n as c,f as L,v as S}from"./index-Up3SR1ci.js";import{V as F}from"./VueLoading-BXeJux7y.js";import{F as M}from"./FooterComponent-BSNsImym.js";var C={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb",BASE_URL:"/vite-milkproject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API:D,VITE_APP_PATH:I}=C,O={components:{VueLoading:F,FooterComponent:M},data(){return{isLoading:!1,total:0,final_total:0,form:{user:{name:"",email:"",tel:"",address:"",delivery:"",pay:"",bill:"",billNum:""},message:""},coupon_code:"",tempAddress:"",expiryDate:"",cardNumber:""}},watch:{"form.user.delivery":"sendDelivery",expiryDate(a,s){a.length===2&&a.length>s.length?this.expiryDate+="/":a.length<s.length&&s.charAt(2)==="/"&&s.length===3&&(this.expiryDate=s.slice(0,1))},cardNumber(a,s){a.length<s.length&&a.charAt(a.length-1)===" "&&(this.cardNumber=s.slice(0,-2)),a.length>s.length&&(a.length+1)%5===0&&this.cardNumber.length!==0&&this.cardNumber.length<19&&(this.cardNumber=a+" ")}},methods:{...q(p,["getCart"]),createOrder(){const a=`${D}api/${I}/order`,s=this.form;this.isLoading=!0,this.$http.post(a,{data:s}).then(_=>{this.isLoading=!1,this.$router.push(`/checkorder/${_.data.orderId}`),this.getCart()}).catch(_=>{U("error",`${_.response.data.message}`)})},sendDelivery(){const{delivery:a}=this.form.user;a!=="外送"&&(this.tempAddress=a)},createOrderData(){this.form.user.address===""&&(this.form.user.address=this.tempAddress),this.createOrder()}},computed:{...P(p,["cart"])},created(){this.getCart()}},E={class:"mb-5"},j={class:"container"},R=T('<div class="d-flex justify-content-center align-items-center my-5 position-relative banner banner2 container-fluid"><h2 class="position-absolute text-center text-white fw-bolder banner-title">結帳流程</h2></div><div class="d-flex justify-content-center align-items-center my-5 mt-3"><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header active"><i class="bi bi-1-circle mb-1"></i><span>填寫資料</span></h5><i class="bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"></i><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"><i class="bi bi-2-circle mb-1"></i><span>確認訂單</span></h5><i class="bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"></i><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"><i class="bi bi-3-circle mb-1"></i><span>訂單完成</span></h5></div>',2),B={class:"row my-5 py-5 rounded-2"},H={class:"col-lg-6"},Y=e("h3",{class:"text-center fw-bold mb-4"},"商品明細",-1),z={class:"table-responsive-md mb-5 mb-lg-0"},G={class:"table align-middle table-borderless"},J=e("thead",{class:"text-center table-secondary"},[e("tr",{class:"table-nowrap"},[e("th",null,"商品名稱"),e("th",{class:"text-nowrap"},"數量"),e("th",{class:"text-end"},"價格")])],-1),K={class:"text-center"},Q={class:"table-nowrap fw-bold text-primary"},W={class:"text-end text-nowrap"},X={key:0,class:"text-danger text-end"},Z=e("td",{colspan:"2",class:"text-end fs-5"},"總計",-1),$={class:"text-end fs-5 text-primary fw-bold"},ee={key:0},se=e("td",{colspan:"2",class:"text-end text-danger fs-5"},"優惠價",-1),le={class:"text-end text-danger fs-5 fw-bold"},te={class:"row col-lg-6"},oe=e("h3",{class:"text-center fw-bold mb-4"},"訂購人資訊",-1),ae={class:"mb-3"},re=e("label",{for:"name",class:"form-label"},[d("姓名"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ie={class:"mb-3"},de=e("label",{for:"email",class:"form-label"},[d("Email"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ne={class:"mb-3"},ce=e("label",{for:"tel",class:"form-label"},[d("電話"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),me={class:"col-12 d-flex align-items-center mb-3"},ue=e("legend",{class:"form-label me-3 me-md-4 mb-0 fs-6 fs-md-5 w-auto"},[d(" 取貨方式"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),fe={class:"d-flex"},be={class:"form-check form-radio me-3"},he=e("label",{class:"form-check-label",for:"本店自取"},"本店自取",-1),_e={class:"form-check form-radio"},pe=e("label",{class:"form-check-label",for:"外送"},"外送",-1),ve={key:0,class:"mb-3"},xe=e("p",{class:"fw-bold mb-1 mb-md-2"},"本店位址: 台南市東東區中中路000號",-1),ge=e("p",{class:"fw-bold"},"聯絡電話: 06-12345678",-1),ye=[xe,ge],Ve={key:1,class:"mb-3"},ke=e("label",{for:"address",class:"form-label"},[d("地址"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),we={class:"col-12 d-flex flex-md-row flex-column align-md-items-center mb-3"},Ae=e("legend",{class:"form-label me-3 me-md-4 fs-6 fs-md-5 w-auto mb-md-0 mb-2"},[d(" 付款方式"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),qe={class:"d-flex"},Ue={class:"form-check form-radio me-3"},Pe=e("label",{class:"form-check-label",for:"信用卡"},"信用卡",-1),Ne={class:"form-check form-radio me-3"},Te=e("label",{class:"form-check-label",for:"ATM 轉帳"},"ATM 轉帳",-1),Le={class:"form-check form-radio"},Se=e("label",{class:"form-check-label",for:"貨到付款"},"貨到付款",-1),Fe={class:"mb-2 mb-md-0"},Me={key:2,class:"mb-3"},Ce=e("label",{for:"cardNum",class:"form-label"},[d("信用卡號"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),De={class:"row"},Ie={class:"col-12"},Oe={class:"my-3 col-12 col-md-6"},Ee=e("label",{for:"period",class:"form-label required"},[d("有效日期"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),je={class:"mb-3 col-12 col-md-6"},Re=e("label",{for:"checkCode",class:"form-label required"},[d("檢查碼"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Be={class:"col-12 d-flex align-items-center mb-3"},He=e("legend",{class:"form-label me-3 me-md-4 mb-0 fs-6 fs-md-5 w-auto"},[d(" 發票類型"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Ye={class:"d-flex"},ze={class:"form-check form-radio me-3"},Ge=e("label",{class:"form-check-label",for:"紙本發票"},"紙本發票",-1),Je={class:"form-check form-radio"},Ke=e("label",{class:"form-check-label",for:"電子載具"},"電子載具",-1),Qe={key:3,class:"mb-3"},We={class:"mb-3"},Xe=e("label",{for:"message",class:"form-label"},"備註",-1),Ze={class:"d-flex justify-content-between"},$e=e("i",{class:"bi bi-caret-left-fill"},null,-1),es=e("button",{type:"submit",class:"btn btn-secondary check-btn"},[d(" 確認訂單"),e("i",{class:"bi bi-caret-right-fill"})],-1);function ss(a,s,_,ls,l,g){const y=f("VueLoading"),i=f("FieldVue"),n=f("ErrorMessage"),V=f("RouterLink"),k=f("FormVue"),w=f("FooterComponent");return m(),u(v,null,[t(y,{active:l.isLoading},null,8,["active"]),e("section",E,[e("div",j,[R,e("div",B,[e("div",H,[Y,e("div",z,[e("table",G,[J,e("tbody",K,[(m(!0),u(v,null,N(a.cart.carts,r=>(m(),u("tr",{class:"table-nowrap",key:r.id},[e("td",Q,h(r.product.title),1),e("td",null,h(r.qty),1),e("td",W,[a.cart.final_total!==a.cart.total?(m(),u("small",X,"優惠價：")):b("",!0),d(" "+h(a.$filters.currency(r.final_total)),1)])]))),128))]),e("tfoot",null,[e("tr",null,[Z,e("td",$,h(a.$filters.currency(a.cart.total)),1)]),a.cart.final_total!==a.cart.total?(m(),u("tr",ee,[se,e("td",le,h(a.$filters.currency(a.cart.final_total)),1)])):b("",!0)])])])]),e("div",te,[oe,t(k,{onSubmit:g.createOrderData},{default:x(({errors:r})=>[e("div",ae,[re,t(i,{id:"name",name:"姓名",type:"text",class:c(["form-control",{"is-invalid":r.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[0]||(s[0]=o=>l.form.user.name=o)},null,8,["class","modelValue"]),t(n,{name:"姓名",class:"invalid-feedback"})]),e("div",ie,[de,t(i,{id:"email",name:"email",type:"email",class:c(["form-control",{"is-invalid":r.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o)},null,8,["class","modelValue"]),t(n,{name:"email",class:"invalid-feedback"})]),e("div",ne,[ce,t(i,{id:"tel",name:"電話",type:"tel",class:c(["form-control",{"is-invalid":r.電話}]),placeholder:"不含 - 符號的手機或室話",rules:"required|numeric|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.tel=o)},null,8,["class","modelValue"]),t(n,{name:"電話",class:"invalid-feedback"})]),e("fieldset",me,[ue,e("div",{class:c(["normal-input",{error:r.取貨方式}])},[e("div",fe,[e("div",be,[t(i,{class:"form-check-input",type:"radio",name:"取貨方式",rules:"required",id:"本店自取",value:"本店自取",modelValue:l.form.user.delivery,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.delivery=o)},null,8,["modelValue"]),he]),e("div",_e,[t(i,{class:"form-check-input",type:"radio",name:"取貨方式",rules:"required",id:"外送",value:"外送",modelValue:l.form.user.delivery,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.delivery=o)},null,8,["modelValue"]),pe])]),t(n,{name:"取貨方式",class:"error-text position-absolute text-danger"})],2)]),l.form.user.delivery==="本店自取"?(m(),u("div",ve,ye)):b("",!0),l.form.user.delivery==="外送"?(m(),u("div",Ve,[ke,t(i,{id:"address",name:"地址",type:"text",class:c(["form-control",{"is-invalid":r.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[5]||(s[5]=o=>l.form.user.address=o)},null,8,["class","modelValue"]),t(n,{name:"地址",class:"invalid-feedback"})])):b("",!0),e("fieldset",we,[Ae,e("div",{class:c(["normal-input",{error:r.付款方式}])},[e("div",qe,[e("div",Ue,[t(i,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"信用卡",value:"信用卡",modelValue:l.form.user.pay,"onUpdate:modelValue":s[6]||(s[6]=o=>l.form.user.pay=o)},null,8,["modelValue"]),Pe]),e("div",Ne,[t(i,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"ATM 轉帳",value:"ATM 轉帳",modelValue:l.form.user.pay,"onUpdate:modelValue":s[7]||(s[7]=o=>l.form.user.pay=o)},null,8,["modelValue"]),Te]),e("div",Le,[t(i,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"貨到付款",value:"貨到付款",modelValue:l.form.user.pay,"onUpdate:modelValue":s[8]||(s[8]=o=>l.form.user.pay=o)},null,8,["modelValue"]),Se])]),e("div",Fe,[t(n,{name:"付款方式",class:"error-text position-absolute text-danger mb-2 mb-md-0"})])],2)]),l.form.user.pay==="信用卡"?(m(),u("div",Me,[Ce,e("div",De,[e("div",Ie,[t(i,{id:"cardNum",name:"卡號",type:"tel",class:c(["form-control",{"is-invalid":r.卡號}]),maxlength:"19",placeholder:"**** **** **** ****",rules:"required",modelValue:l.cardNumber,"onUpdate:modelValue":s[9]||(s[9]=o=>l.cardNumber=o)},null,8,["class","modelValue"]),t(n,{name:"卡號",class:"invalid-feedback"}),e("div",Oe,[Ee,t(i,{id:"period",name:"有效日期",type:"tel",class:c(["form-control",{"is-invalid":r.有效日期}]),placeholder:"MM/YY",maxlength:"5",modelValue:l.expiryDate,"onUpdate:modelValue":s[10]||(s[10]=o=>l.expiryDate=o),rules:"required"},null,8,["modelValue","class"]),t(n,{name:"有效日期",class:"invalid-feedback"})]),e("div",je,[Re,t(i,{id:"checkCode",name:"檢查碼",type:"text",class:c(["form-control",{"is-invalid":r.檢查碼}]),maxlength:"3",placeholder:"CVC/CVV",rules:"required|length:3|numeric:true"},null,8,["class"]),t(n,{name:"檢查碼",class:"invalid-feedback"})])])])])):b("",!0),e("fieldset",Be,[He,e("div",{class:c(["normal-input",{error:r.發票類型}])},[e("div",Ye,[e("div",ze,[t(i,{class:"form-check-input",type:"radio",name:"發票類型",rules:"required",id:"紙本發票",value:"紙本發票",modelValue:l.form.user.bill,"onUpdate:modelValue":s[11]||(s[11]=o=>l.form.user.bill=o)},null,8,["modelValue"]),Ge]),e("div",Je,[t(i,{class:"form-check-input",type:"radio",name:"發票類型",rules:"required",id:"電子載具",value:"電子載具",modelValue:l.form.user.bill,"onUpdate:modelValue":s[12]||(s[12]=o=>l.form.user.bill=o)},null,8,["modelValue"]),Ke])]),t(n,{name:"發票類型",class:"error-text position-absolute text-danger"})],2)]),l.form.user.bill==="電子載具"?(m(),u("div",Qe,[t(i,{name:"電子載具",type:"text",class:c(["form-control",{"is-invalid":r.電子載具}]),placeholder:"請輸入  '/'  開頭的載具號碼",rules:"required",modelValue:l.form.user.billNum,"onUpdate:modelValue":s[13]||(s[13]=o=>l.form.user.billNum=o)},null,8,["class","modelValue"]),t(n,{name:"電子載具",class:"invalid-feedback"})])):b("",!0),e("div",We,[Xe,L(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[14]||(s[14]=o=>l.form.message=o)},null,512),[[S,l.form.message]])]),e("div",Ze,[t(V,{class:"btn btn-outline-primary",to:"/cart"},{default:x(()=>[$e,d("回上一頁")]),_:1}),es])]),_:1},8,["onSubmit"])])])])]),t(w)],64)}const rs=A(O,[["render",ss]]);export{rs as default};
