import{_ as M,u as F,j as S,s as L,l as b,f as C,A as w,n as I,r as h,o as f,c as u,b as a,a as e,F as P,q as N,t as g,x as v,w as T,i as R,S as E,d as O,e as i,p as m,g as j,v as D}from"./index-If2eL0tu.js";import{V as B}from"./VueLoading-D62Lhxuy.js";import{F as H}from"./FooterComponent-DHjU0z8R.js";var Y={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb",BASE_URL:"/vite-milkproject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API:z,VITE_APP_PATH:G}=Y,J={components:{VueLoading:B,FooterComponent:H},setup(){const p=F(),s=S(),{cart:q}=L(s),l=b(!1),A=b(0),U=b(0),V=b(""),t=b(""),d=b(""),x=b(""),_=C({user:{name:"",email:"",tel:"",address:"",delivery:"",pay:"",bill:"",billNum:""},message:""});w(d,(n,c)=>{n.length<c.length&&n.charAt(n.length-1)===" "&&(d.value=c.slice(0,-2)),n.length>c.length&&(n.length+1)%5===0&&d.value.length!==0&&d.value.length<19&&(d.value=n+" ")}),w(()=>_.user.delivery,r),w(t,(n,c)=>{n.length===2&&n.length>c.length?t.value+="/":n.length<c.length&&c.charAt(2)==="/"&&c.length===3&&(t.value=c.slice(0,1))});function y(){const n=`${z}api/${G}/order`,c=_;l.value=!0,R.post(n,{data:c}).then(k=>{l.value=!1,p.push(`/checkorder/${k.data.orderId}`),s.getCart()}).catch(k=>{l.value=!1,E("error",`${k.response.data.message}`)})}function r(){const{delivery:n}=_.user;n!=="外送"&&(x.value=n)}function o(){_.user.address===""&&(_.user.address=x.value),y()}return I(()=>{s.getCart()}),{isLoading:l,total:A,final_total:U,form:_,coupon_code:V,expiryDate:t,cardNumber:d,cart:q,createOrder:y,tempAddress:x,sendDelivery:r,createOrderData:o}}},K={class:"mb-5"},Q={class:"container"},W=O('<div class="d-flex justify-content-center align-items-center my-5 position-relative banner banner2 container-fluid"><h2 class="position-absolute text-center text-white fw-bolder banner-title">結帳流程</h2></div><div class="d-flex justify-content-center align-items-center my-5 mt-3"><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header active"><i class="bi bi-1-circle mb-1"></i><span>填寫資料</span></h5><i class="bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"></i><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"><i class="bi bi-2-circle mb-1"></i><span>確認訂單</span></h5><i class="bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"></i><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"><i class="bi bi-3-circle mb-1"></i><span>訂單完成</span></h5></div>',2),X={class:"row my-5 py-5 rounded-2"},Z={class:"col-lg-6"},$=e("h3",{class:"text-center fw-bold mb-4"},"商品明細",-1),ee={class:"table-responsive-md mb-5 mb-lg-0"},le={class:"table align-middle table-borderless"},se=e("thead",{class:"text-center table-secondary"},[e("tr",{class:"table-nowrap"},[e("th",null,"商品名稱"),e("th",{class:"text-nowrap"},"數量"),e("th",{class:"text-end"},"價格")])],-1),oe={class:"text-center"},ae={class:"table-nowrap fw-bold text-primary"},te={class:"text-end text-nowrap"},re={key:0,class:"text-danger text-end"},de=e("td",{colspan:"2",class:"text-end fs-5"},"總計",-1),ne={class:"text-end fs-5 text-primary fw-bold"},ie={key:0},ce=e("td",{colspan:"2",class:"text-end text-danger fs-5"},"優惠價",-1),me={class:"text-end text-danger fs-5 fw-bold"},fe={class:"row col-lg-6"},ue=e("h3",{class:"text-center fw-bold mb-4"},"訂購人資訊",-1),_e={class:"mb-3"},be=e("label",{for:"name",class:"form-label"},[i("姓名"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),he={class:"mb-3"},ve=e("label",{for:"email",class:"form-label"},[i("Email"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),pe={class:"mb-3"},xe=e("label",{for:"tel",class:"form-label"},[i("電話"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ge={class:"col-12 d-flex align-items-center mb-3"},ye=e("legend",{class:"form-label me-3 me-md-4 mb-0 fs-6 fs-md-5 w-auto"},[i(" 取貨方式"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Ve={class:"d-flex"},ke={class:"form-check form-radio me-3"},we=e("label",{class:"form-check-label",for:"本店自取"},"本店自取",-1),qe={class:"form-check form-radio"},Ae=e("label",{class:"form-check-label",for:"外送"},"外送",-1),Ue={key:0,class:"mb-3"},Pe=e("p",{class:"fw-bold mb-1 mb-md-2"},"本店位址: 台南市東東區中中路000號",-1),Te=e("p",{class:"fw-bold"},"聯絡電話: 06-12345678",-1),Me=[Pe,Te],Fe={key:1,class:"mb-3"},Se=e("label",{for:"address",class:"form-label"},[i("地址"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Le={class:"col-12 d-flex flex-md-row flex-column align-md-items-center mb-3"},Ce=e("legend",{class:"form-label me-3 me-md-4 fs-6 fs-md-5 w-auto mb-md-0 mb-2"},[i(" 付款方式"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Ie={class:"d-flex"},Ne={class:"form-check form-radio me-3"},Re=e("label",{class:"form-check-label",for:"信用卡"},"信用卡",-1),Ee={class:"form-check form-radio me-3"},Oe=e("label",{class:"form-check-label",for:"ATM 轉帳"},"ATM 轉帳",-1),je={class:"form-check form-radio"},De=e("label",{class:"form-check-label",for:"貨到付款"},"貨到付款",-1),Be={class:"mb-2 mb-md-0"},He={key:2,class:"mb-3"},Ye=e("label",{for:"cardNum",class:"form-label"},[i("信用卡號"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ze={class:"row"},Ge={class:"col-12"},Je={class:"my-3 col-12 col-md-6"},Ke=e("label",{for:"period",class:"form-label required"},[i("有效日期"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Qe={class:"mb-3 col-12 col-md-6"},We=e("label",{for:"checkCode",class:"form-label required"},[i("檢查碼"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Xe={class:"col-12 d-flex align-items-center mb-3"},Ze=e("legend",{class:"form-label me-3 me-md-4 mb-0 fs-6 fs-md-5 w-auto"},[i(" 發票類型"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),$e={class:"d-flex"},el={class:"form-check form-radio me-3"},ll=e("label",{class:"form-check-label",for:"紙本發票"},"紙本發票",-1),sl={class:"form-check form-radio"},ol=e("label",{class:"form-check-label",for:"電子載具"},"電子載具",-1),al={key:3,class:"mb-3"},tl={class:"mb-3"},rl=e("label",{for:"message",class:"form-label"},"備註",-1),dl={class:"d-flex justify-content-between"},nl=e("i",{class:"bi bi-caret-left-fill"},null,-1),il=e("button",{type:"submit",class:"btn btn-secondary check-btn"},[i(" 確認訂單"),e("i",{class:"bi bi-caret-right-fill"})],-1);function cl(p,s,q,l,A,U){const V=h("VueLoading"),t=h("FieldVue"),d=h("ErrorMessage"),x=h("RouterLink"),_=h("FormVue"),y=h("FooterComponent");return f(),u(P,null,[a(V,{active:l.isLoading},null,8,["active"]),e("section",K,[e("div",Q,[W,e("div",X,[e("div",Z,[$,e("div",ee,[e("table",le,[se,e("tbody",oe,[(f(!0),u(P,null,N(l.cart.carts,r=>(f(),u("tr",{class:"table-nowrap",key:r.id},[e("td",ae,g(r.product.title),1),e("td",null,g(r.qty),1),e("td",te,[l.cart.final_total!==l.cart.total?(f(),u("small",re,"優惠價：")):v("",!0),i(" "+g(p.$filters.currency(r.final_total)),1)])]))),128))]),e("tfoot",null,[e("tr",null,[de,e("td",ne,g(p.$filters.currency(l.cart.total)),1)]),l.cart.final_total!==l.cart.total?(f(),u("tr",ie,[ce,e("td",me,g(p.$filters.currency(l.cart.final_total)),1)])):v("",!0)])])])]),e("div",fe,[ue,a(_,{onSubmit:l.createOrderData},{default:T(({errors:r})=>[e("div",_e,[be,a(t,{id:"name",name:"姓名",type:"text",class:m(["form-control",{"is-invalid":r.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[0]||(s[0]=o=>l.form.user.name=o)},null,8,["class","modelValue"]),a(d,{name:"姓名",class:"invalid-feedback"})]),e("div",he,[ve,a(t,{id:"email",name:"email",type:"email",class:m(["form-control",{"is-invalid":r.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o)},null,8,["class","modelValue"]),a(d,{name:"email",class:"invalid-feedback"})]),e("div",pe,[xe,a(t,{id:"tel",name:"電話",type:"tel",class:m(["form-control",{"is-invalid":r.電話}]),placeholder:"不含 - 符號的手機或室話",rules:"required|numeric|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.tel=o)},null,8,["class","modelValue"]),a(d,{name:"電話",class:"invalid-feedback"})]),e("fieldset",ge,[ye,e("div",{class:m(["normal-input",{error:r.取貨方式}])},[e("div",Ve,[e("div",ke,[a(t,{class:"form-check-input",type:"radio",name:"取貨方式",rules:"required",id:"本店自取",value:"本店自取",modelValue:l.form.user.delivery,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.delivery=o)},null,8,["modelValue"]),we]),e("div",qe,[a(t,{class:"form-check-input",type:"radio",name:"取貨方式",rules:"required",id:"外送",value:"外送",modelValue:l.form.user.delivery,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.delivery=o)},null,8,["modelValue"]),Ae])]),a(d,{name:"取貨方式",class:"error-text position-absolute text-danger"})],2)]),l.form.user.delivery==="本店自取"?(f(),u("div",Ue,Me)):v("",!0),l.form.user.delivery==="外送"?(f(),u("div",Fe,[Se,a(t,{id:"address",name:"地址",type:"text",class:m(["form-control",{"is-invalid":r.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[5]||(s[5]=o=>l.form.user.address=o)},null,8,["class","modelValue"]),a(d,{name:"地址",class:"invalid-feedback"})])):v("",!0),e("fieldset",Le,[Ce,e("div",{class:m(["normal-input",{error:r.付款方式}])},[e("div",Ie,[e("div",Ne,[a(t,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"信用卡",value:"信用卡",modelValue:l.form.user.pay,"onUpdate:modelValue":s[6]||(s[6]=o=>l.form.user.pay=o)},null,8,["modelValue"]),Re]),e("div",Ee,[a(t,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"ATM 轉帳",value:"ATM 轉帳",modelValue:l.form.user.pay,"onUpdate:modelValue":s[7]||(s[7]=o=>l.form.user.pay=o)},null,8,["modelValue"]),Oe]),e("div",je,[a(t,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"貨到付款",value:"貨到付款",modelValue:l.form.user.pay,"onUpdate:modelValue":s[8]||(s[8]=o=>l.form.user.pay=o)},null,8,["modelValue"]),De])]),e("div",Be,[a(d,{name:"付款方式",class:"error-text position-absolute text-danger mb-2 mb-md-0"})])],2)]),l.form.user.pay==="信用卡"?(f(),u("div",He,[Ye,e("div",ze,[e("div",Ge,[a(t,{id:"cardNum",name:"卡號",type:"tel",class:m(["form-control",{"is-invalid":r.卡號}]),maxlength:"19",placeholder:"**** **** **** ****",rules:"required",modelValue:l.cardNumber,"onUpdate:modelValue":s[9]||(s[9]=o=>l.cardNumber=o)},null,8,["class","modelValue"]),a(d,{name:"卡號",class:"invalid-feedback"}),e("div",Je,[Ke,a(t,{id:"period",name:"有效日期",type:"tel",class:m(["form-control",{"is-invalid":r.有效日期}]),placeholder:"MM/YY",maxlength:"5",modelValue:l.expiryDate,"onUpdate:modelValue":s[10]||(s[10]=o=>l.expiryDate=o),rules:"required"},null,8,["modelValue","class"]),a(d,{name:"有效日期",class:"invalid-feedback"})]),e("div",Qe,[We,a(t,{id:"checkCode",name:"檢查碼",type:"text",class:m(["form-control",{"is-invalid":r.檢查碼}]),maxlength:"3",placeholder:"CVC/CVV",rules:"required|length:3|numeric:true"},null,8,["class"]),a(d,{name:"檢查碼",class:"invalid-feedback"})])])])])):v("",!0),e("fieldset",Xe,[Ze,e("div",{class:m(["normal-input",{error:r.發票類型}])},[e("div",$e,[e("div",el,[a(t,{class:"form-check-input",type:"radio",name:"發票類型",rules:"required",id:"紙本發票",value:"紙本發票",modelValue:l.form.user.bill,"onUpdate:modelValue":s[11]||(s[11]=o=>l.form.user.bill=o)},null,8,["modelValue"]),ll]),e("div",sl,[a(t,{class:"form-check-input",type:"radio",name:"發票類型",rules:"required",id:"電子載具",value:"電子載具",modelValue:l.form.user.bill,"onUpdate:modelValue":s[12]||(s[12]=o=>l.form.user.bill=o)},null,8,["modelValue"]),ol])]),a(d,{name:"發票類型",class:"error-text position-absolute text-danger"})],2)]),l.form.user.bill==="電子載具"?(f(),u("div",al,[a(t,{name:"電子載具",type:"text",class:m(["form-control",{"is-invalid":r.電子載具}]),placeholder:"請輸入  '/'  開頭的載具號碼",rules:"required",modelValue:l.form.user.billNum,"onUpdate:modelValue":s[13]||(s[13]=o=>l.form.user.billNum=o)},null,8,["class","modelValue"]),a(d,{name:"電子載具",class:"invalid-feedback"})])):v("",!0),e("div",tl,[rl,j(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[14]||(s[14]=o=>l.form.message=o)},null,512),[[D,l.form.message]])]),e("div",dl,[a(x,{class:"btn btn-outline-primary",to:"/cart"},{default:T(()=>[nl,i("回上一頁")]),_:1}),il])]),_:1},8,["onSubmit"])])])])]),a(y)],64)}const _l=M(J,[["render",cl]]);export{_l as default};
