import{_ as C,i as I,l as j,u as O,g as m,n as R,r as x,o,c as n,b as w,a as t,p as k,x as f,h as S,F as P,q as T,t as a,w as F,S as y,e as E}from"./index-B9ihJxSl.js";import{V as N}from"./VueLoading-BiyQmFRl.js";import{F as B}from"./FooterComponent-BlvGq1gU.js";var D={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb",BASE_URL:"/vite-milkproject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API:V,VITE_APP_PATH:A}=D,M={components:{VueLoading:N,FooterComponent:B},setup(){const l=I("$axios"),u=j(),p=O(),e=m({user:{}}),c=m(""),r=m(!1);function i(){const d=`${V}api/${A}/order/${c.value}`;r.value=!0,l.get(d).then(s=>{s.data.success&&(e.value=s.data.order)}).catch(s=>{var _,h,g;if(((_=s.response)==null?void 0:_.status)===404)p.push("/not-found");else{const L=((g=(h=s.response)==null?void 0:h.data)==null?void 0:g.message)||"發生錯誤，請稍後再試";y("error",L)}}).finally(()=>{r.value=!1})}function b(){const d=`${V}api/${A}/pay/${c.value}`;r.value=!0,l.post(d).then(s=>{s.data.success&&(y("success","付款成功"),i())}).catch(s=>{var _,h;const v=((h=(_=s.response)==null?void 0:_.data)==null?void 0:h.message)||"發生錯誤，請稍後再試";y("error",v)}).finally(()=>{r.value=!1})}return R(()=>{if(c.value=u.params.orderId,!c.value){p.push("/not-found");return}i()}),{order:e,orderId:c,isLoading:r,getOrder:i,payOrder:b}}},q={class:"mb-5"},H={class:"container"},U=t("div",{class:"d-flex justify-content-center align-items-center my-5 position-relative banner banner2 container-fluid"},[t("h2",{class:"position-absolute text-center text-white fw-bolder banner-title"},"結帳流程")],-1),z={class:"d-flex justify-content-center align-items-center mb-5 mt-3"},G=t("h5",{class:"d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"},[t("i",{class:"bi bi-1-circle mb-1"}),t("span",null,"填寫資料")],-1),J=t("i",{class:"bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"},null,-1),K=t("i",{class:"bi bi-2-circle mb-1"},null,-1),Q=t("span",null,"確認訂單",-1),W=[K,Q],X=t("i",{class:"bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"},null,-1),Y=t("i",{class:"bi bi-3-circle mb-1"},null,-1),Z=t("span",null,"訂單完成",-1),$=[Y,Z],tt={class:"row justify-content-center align-items-center"},et={class:"col-md-10"},st={key:0,class:"d-flex justify-content-center align-items-center mt-5"},ot=t("i",{class:"bi bi-bag-check-fill fs-2 pe-2 text-success"},null,-1),nt=t("h2",{class:"fw-bold mb-0 text-success"},"訂購成功 !",-1),at=[ot,nt],ct={key:1,class:"fw-bold mt-4 mb-5 text-center"},rt={class:"my-5 row justify-content-center"},lt=t("h3",{class:"text-center fw-bold mb-4"},"訂單明細",-1),it={class:"table align-middle table-light table-borderless mb-4"},dt=t("thead",{class:"text-center"},[t("tr",null,[t("th",{class:"text-nowrap"},"商品名稱"),t("th",{class:"text-center text-nowrap"},"數量"),t("th",{class:"text-nowrap"},"價格")])],-1),_t={class:"text-center"},ht={class:"text-center text-nowrap"},ut={class:"text-center text-nowrap"},ft=t("td",{colspan:"2",class:"text-end text-nowrap"},"總計",-1),pt={class:"fs-5 text-primary fw-bold text-nowrap"},bt=t("h3",{class:"text-center fw-bold mb-4"},"訂購人資訊",-1),mt={class:"table table-light table-borderless mb-4"},xt={class:"table-nowrap"},wt=t("th",{class:"text-nowrap"},"姓名",-1),yt={class:"text-nowrap"},vt={class:"table-nowrap"},gt=t("th",{width:"100",class:"text-nowrap"},"Email",-1),kt={class:"text-nowrap"},Pt={class:"table-nowrap"},Vt=t("th",{class:"text-nowrap"},"電話",-1),At={class:"text-nowrap"},Et={class:"table-nowrap"},Lt=t("th",{class:"text-nowrap"},"付款方式",-1),Ct={class:"text-nowrap"},It={class:"table-nowrap"},jt=t("th",null,"訂購狀態",-1),Ot={key:0,class:"text-nowrap text-danger fw-bold"},Rt={key:1,class:"text-success fw-bold text-nowrap"},St={key:0,class:"text-end"},Tt=t("button",{class:"btn btn-primary ms-auto",type:"submit"},[E(" 確認訂購"),t("i",{class:"bi bi-caret-right-fill"})],-1),Ft=[Tt],Nt={key:1,class:"text-end"},Bt=t("i",{class:"bi bi-cart4 pe-1 fs-5"},null,-1);function Dt(l,u,p,e,c,r){const i=x("VueLoading"),b=x("RouterLink"),d=x("FooterComponent");return o(),n(P,null,[w(i,{active:e.isLoading},null,8,["active"]),t("section",q,[t("div",H,[U,t("div",z,[G,J,t("h5",{class:k(["d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header",{active:e.order.is_paid===!1}])},W,2),X,t("h5",{class:k(["d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header",{active:e.order.is_paid===!0}])},$,2)]),t("div",tt,[t("div",et,[e.order.is_paid===!0?(o(),n("div",st,at)):f("",!0),e.order.is_paid===!0?(o(),n("h6",ct," 感謝您的訂購，訂單明細將會寄送至您的電子信箱 ! ")):f("",!0),t("div",rt,[lt,t("form",{class:"col-lg-6",onSubmit:u[0]||(u[0]=S((...s)=>e.payOrder&&e.payOrder(...s),["prevent"]))},[t("table",it,[dt,t("tbody",null,[(o(!0),n(P,null,T(e.order.products,s=>(o(),n("tr",{key:s.id},[t("td",_t,a(s.product.title),1),t("td",ht,a(s.qty),1),t("td",ut,a(l.$format.currency(s.final_total)),1)]))),128))]),t("tfoot",null,[t("tr",null,[ft,t("td",pt,a(l.$format.currency(e.order.total)),1)])])]),bt,t("table",mt,[t("tbody",null,[t("tr",xt,[wt,t("td",yt,a(e.order.user.name),1)]),t("tr",vt,[gt,t("td",kt,a(e.order.user.email),1)]),t("tr",Pt,[Vt,t("td",At,a(e.order.user.tel),1)]),t("tr",Et,[Lt,t("td",Ct,a(e.order.user.pay),1)]),t("tr",It,[jt,t("td",null,[e.order.is_paid?(o(),n("span",Rt,"訂購完成")):(o(),n("span",Ot,"尚未訂購"))])])])]),e.order.is_paid===!1?(o(),n("div",St,Ft)):f("",!0),e.order.is_paid===!0?(o(),n("div",Nt,[w(b,{to:"/products",class:"btn btn-primary ms-auto"},{default:F(()=>[Bt,E("繼續選購")]),_:1})])):f("",!0)],32)])])])])]),w(d)],64)}const Ut=C(M,[["render",Dt]]);export{Ut as default};
