import{_ as L,i as I,u as N,k as R,s as j,g as h,f as E,A,n as O,r as v,o as f,c as u,b as a,a as e,F as M,q as D,t as y,x as p,w as F,S as B,d as H,e as i,p as m,j as Y,v as z}from"./index-qonDLBNP.js";import{V as G}from"./VueLoading-Xsc90l01.js";import{F as J}from"./FooterComponent-C39UDiwj.js";var K={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb",BASE_URL:"/vite-milkproject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API:Q,VITE_APP_PATH:W}=K,X={components:{VueLoading:G,FooterComponent:J},setup(){const x=I("$axios"),s=N(),V=R(),{cart:l}=j(V),k=h(!1),U=h(0),w=h(0),r=h(""),d=h(""),_=h(""),g=h(""),b=E({user:{name:"",email:"",tel:"",address:"",delivery:"",pay:"",bill:"",billNum:""},message:""});A(_,(n,c)=>{n.length<c.length&&n.charAt(n.length-1)===" "&&(_.value=c.slice(0,-2)),n.length>c.length&&(n.length+1)%5===0&&_.value.length!==0&&_.value.length<19&&(_.value=n+" ")}),A(()=>b.user.delivery,o),A(d,(n,c)=>{n.length===2&&n.length>c.length?d.value+="/":n.length<c.length&&c.charAt(2)==="/"&&c.length===3&&(d.value=c.slice(0,1))});function t(){const n=`${Q}api/${W}/order`,c=b;k.value=!0,x.post(n,{data:c}).then(q=>{s.push(`/checkorder/${q.data.orderId}`),V.getCart()}).catch(q=>{var P,T;const C=((T=(P=q.response)==null?void 0:P.data)==null?void 0:T.message)||"發生錯誤，請稍後再試";B("error",C)}).finally(()=>{k.value=!1})}function o(){const{delivery:n}=b.user;n!=="外送"&&(g.value=n)}function S(){b.user.address===""&&(b.user.address=g.value),t()}return O(()=>{V.getCart()}),{isLoading:k,total:U,final_total:w,form:b,coupon_code:r,expiryDate:d,cardNumber:_,cart:l,createOrder:t,tempAddress:g,sendDelivery:o,createOrderData:S}}},Z={class:"mb-5"},$={class:"container"},ee=H('<div class="d-flex justify-content-center align-items-center my-5 position-relative banner banner2 container-fluid"><h2 class="position-absolute text-center text-white fw-bolder banner-title">結帳流程</h2></div><div class="d-flex justify-content-center align-items-center my-5 mt-3"><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header active"><i class="bi bi-1-circle mb-1"></i><span>填寫資料</span></h5><i class="bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"></i><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"><i class="bi bi-2-circle mb-1"></i><span>確認訂單</span></h5><i class="bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"></i><h5 class="d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"><i class="bi bi-3-circle mb-1"></i><span>訂單完成</span></h5></div>',2),le={class:"row my-5 py-5 rounded-2"},se={class:"col-lg-6"},oe=e("h3",{class:"text-center fw-bold mb-4"},"商品明細",-1),ae={class:"table-responsive-md mb-5 mb-lg-0"},te={class:"table align-middle table-borderless"},re=e("thead",{class:"text-center table-secondary"},[e("tr",{class:"table-nowrap"},[e("th",null,"商品名稱"),e("th",{class:"text-nowrap"},"數量"),e("th",{class:"text-end"},"價格")])],-1),de={class:"text-center"},ne={class:"table-nowrap fw-bold text-primary"},ie={class:"text-end text-nowrap"},ce={key:0,class:"text-danger text-end"},me=e("td",{colspan:"2",class:"text-end fs-5"},"總計",-1),fe={class:"text-end fs-5 text-primary fw-bold"},ue={key:0},_e=e("td",{colspan:"2",class:"text-end text-danger fs-5"},"優惠價",-1),be={class:"text-end text-danger fs-5 fw-bold"},he={class:"row col-lg-6"},ve=e("h3",{class:"text-center fw-bold mb-4"},"訂購人資訊",-1),pe={class:"mb-3"},xe=e("label",{for:"name",class:"form-label"},[i("姓名"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ge={class:"mb-3"},ye=e("label",{for:"email",class:"form-label"},[i("Email"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Ve={class:"mb-3"},ke=e("label",{for:"tel",class:"form-label"},[i("電話"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),we={class:"col-12 d-flex align-items-center mb-3"},qe=e("legend",{class:"form-label me-3 me-md-4 mb-0 fs-6 fs-md-5 w-auto"},[i(" 取貨方式"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Ae={class:"d-flex"},Ue={class:"form-check form-radio me-3"},Pe=e("label",{class:"form-check-label",for:"本店自取"},"本店自取",-1),Te={class:"form-check form-radio"},Me=e("label",{class:"form-check-label",for:"外送"},"外送",-1),Fe={key:0,class:"mb-3"},Se=e("p",{class:"fw-bold mb-1 mb-md-2"},"本店位址: 台南市東東區中中路000號",-1),Ce=e("p",{class:"fw-bold"},"聯絡電話: 06-1234567",-1),Le=[Se,Ce],Ie={key:1,class:"mb-3"},Ne=e("label",{for:"address",class:"form-label"},[i("地址"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Re={class:"col-12 d-flex flex-md-row flex-column align-md-items-center mb-3"},je=e("legend",{class:"form-label me-3 me-md-4 fs-6 fs-md-5 w-auto mb-md-0 mb-2"},[i(" 付款方式"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Ee={class:"d-flex"},Oe={class:"form-check form-radio me-3"},De=e("label",{class:"form-check-label",for:"信用卡"},"信用卡",-1),Be={class:"form-check form-radio me-3"},He=e("label",{class:"form-check-label",for:"ATM 轉帳"},"ATM 轉帳",-1),Ye={class:"form-check form-radio"},ze=e("label",{class:"form-check-label",for:"貨到付款"},"貨到付款",-1),Ge={class:"mb-2 mb-md-0"},Je={key:2,class:"mb-3"},Ke=e("label",{for:"cardNum",class:"form-label"},[i("信用卡號"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),Qe={class:"row"},We={class:"col-12"},Xe={class:"my-3 col-12 col-md-6"},Ze=e("label",{for:"period",class:"form-label required"},[i("有效日期"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),$e={class:"mb-3 col-12 col-md-6"},el=e("label",{for:"checkCode",class:"form-label required"},[i("檢查碼"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ll={class:"col-12 d-flex align-items-center mb-3"},sl=e("legend",{class:"form-label me-3 me-md-4 mb-0 fs-6 fs-md-5 w-auto"},[i(" 發票類型"),e("small",{class:"ps-1 text-danger fw-bold"},"*")],-1),ol={class:"d-flex"},al={class:"form-check form-radio me-3"},tl=e("label",{class:"form-check-label",for:"紙本發票"},"紙本發票",-1),rl={class:"form-check form-radio"},dl=e("label",{class:"form-check-label",for:"電子載具"},"電子載具",-1),nl={key:3,class:"mb-3"},il={class:"mb-3"},cl=e("label",{for:"message",class:"form-label"},"備註",-1),ml={class:"d-flex justify-content-between"},fl=e("i",{class:"bi bi-caret-left-fill"},null,-1),ul=e("button",{type:"submit",class:"btn btn-secondary check-btn"},[i(" 確認訂單"),e("i",{class:"bi bi-caret-right-fill"})],-1);function _l(x,s,V,l,k,U){const w=v("VueLoading"),r=v("FieldVue"),d=v("ErrorMessage"),_=v("RouterLink"),g=v("FormVue"),b=v("FooterComponent");return f(),u(M,null,[a(w,{active:l.isLoading},null,8,["active"]),e("section",Z,[e("div",$,[ee,e("div",le,[e("div",se,[oe,e("div",ae,[e("table",te,[re,e("tbody",de,[(f(!0),u(M,null,D(l.cart.carts,t=>(f(),u("tr",{class:"table-nowrap",key:t.id},[e("td",ne,y(t.product.title),1),e("td",null,y(t.qty),1),e("td",ie,[l.cart.final_total!==l.cart.total?(f(),u("small",ce,"優惠價：")):p("",!0),i(" "+y(x.$format.currency(t.final_total)),1)])]))),128))]),e("tfoot",null,[e("tr",null,[me,e("td",fe,y(x.$format.currency(l.cart.total)),1)]),l.cart.final_total!==l.cart.total?(f(),u("tr",ue,[_e,e("td",be,y(x.$format.currency(l.cart.final_total)),1)])):p("",!0)])])])]),e("div",he,[ve,a(g,{onSubmit:l.createOrderData},{default:F(({errors:t})=>[e("div",pe,[xe,a(r,{id:"name",name:"姓名",type:"text",class:m(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[0]||(s[0]=o=>l.form.user.name=o)},null,8,["class","modelValue"]),a(d,{name:"姓名",class:"invalid-feedback"})]),e("div",ge,[ye,a(r,{id:"email",name:"email",type:"email",class:m(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o)},null,8,["class","modelValue"]),a(d,{name:"email",class:"invalid-feedback"})]),e("div",Ve,[ke,a(r,{id:"tel",name:"電話",type:"tel",class:m(["form-control",{"is-invalid":t.電話}]),placeholder:"不含 - 符號的手機或室話",rules:"required|numeric|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.tel=o)},null,8,["class","modelValue"]),a(d,{name:"電話",class:"invalid-feedback"})]),e("fieldset",we,[qe,e("div",{class:m(["normal-input",{error:t.取貨方式}])},[e("div",Ae,[e("div",Ue,[a(r,{class:"form-check-input",type:"radio",name:"取貨方式",rules:"required",id:"本店自取",value:"本店自取",modelValue:l.form.user.delivery,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.delivery=o)},null,8,["modelValue"]),Pe]),e("div",Te,[a(r,{class:"form-check-input",type:"radio",name:"取貨方式",rules:"required",id:"外送",value:"外送",modelValue:l.form.user.delivery,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.delivery=o)},null,8,["modelValue"]),Me])]),a(d,{name:"取貨方式",class:"error-text position-absolute text-danger"})],2)]),l.form.user.delivery==="本店自取"?(f(),u("div",Fe,Le)):p("",!0),l.form.user.delivery==="外送"?(f(),u("div",Ie,[Ne,a(r,{id:"address",name:"地址",type:"text",class:m(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[5]||(s[5]=o=>l.form.user.address=o)},null,8,["class","modelValue"]),a(d,{name:"地址",class:"invalid-feedback"})])):p("",!0),e("fieldset",Re,[je,e("div",{class:m(["normal-input",{error:t.付款方式}])},[e("div",Ee,[e("div",Oe,[a(r,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"信用卡",value:"信用卡",modelValue:l.form.user.pay,"onUpdate:modelValue":s[6]||(s[6]=o=>l.form.user.pay=o)},null,8,["modelValue"]),De]),e("div",Be,[a(r,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"ATM 轉帳",value:"ATM 轉帳",modelValue:l.form.user.pay,"onUpdate:modelValue":s[7]||(s[7]=o=>l.form.user.pay=o)},null,8,["modelValue"]),He]),e("div",Ye,[a(r,{class:"form-check-input",type:"radio",name:"付款方式",rules:"required",id:"貨到付款",value:"貨到付款",modelValue:l.form.user.pay,"onUpdate:modelValue":s[8]||(s[8]=o=>l.form.user.pay=o)},null,8,["modelValue"]),ze])]),e("div",Ge,[a(d,{name:"付款方式",class:"error-text position-absolute text-danger mb-2 mb-md-0"})])],2)]),l.form.user.pay==="信用卡"?(f(),u("div",Je,[Ke,e("div",Qe,[e("div",We,[a(r,{id:"cardNum",name:"卡號",type:"tel",class:m(["form-control",{"is-invalid":t.卡號}]),maxlength:"19",placeholder:"**** **** **** ****",rules:"required",modelValue:l.cardNumber,"onUpdate:modelValue":s[9]||(s[9]=o=>l.cardNumber=o)},null,8,["class","modelValue"]),a(d,{name:"卡號",class:"invalid-feedback"}),e("div",Xe,[Ze,a(r,{id:"period",name:"有效日期",type:"tel",class:m(["form-control",{"is-invalid":t.有效日期}]),placeholder:"MM/YY",maxlength:"5",modelValue:l.expiryDate,"onUpdate:modelValue":s[10]||(s[10]=o=>l.expiryDate=o),rules:"required"},null,8,["modelValue","class"]),a(d,{name:"有效日期",class:"invalid-feedback"})]),e("div",$e,[el,a(r,{id:"checkCode",name:"檢查碼",type:"text",class:m(["form-control",{"is-invalid":t.檢查碼}]),maxlength:"3",placeholder:"CVC/CVV",rules:"required|length:3|numeric:true"},null,8,["class"]),a(d,{name:"檢查碼",class:"invalid-feedback"})])])])])):p("",!0),e("fieldset",ll,[sl,e("div",{class:m(["normal-input",{error:t.發票類型}])},[e("div",ol,[e("div",al,[a(r,{class:"form-check-input",type:"radio",name:"發票類型",rules:"required",id:"紙本發票",value:"紙本發票",modelValue:l.form.user.bill,"onUpdate:modelValue":s[11]||(s[11]=o=>l.form.user.bill=o)},null,8,["modelValue"]),tl]),e("div",rl,[a(r,{class:"form-check-input",type:"radio",name:"發票類型",rules:"required",id:"電子載具",value:"電子載具",modelValue:l.form.user.bill,"onUpdate:modelValue":s[12]||(s[12]=o=>l.form.user.bill=o)},null,8,["modelValue"]),dl])]),a(d,{name:"發票類型",class:"error-text position-absolute text-danger"})],2)]),l.form.user.bill==="電子載具"?(f(),u("div",nl,[a(r,{name:"電子載具",type:"text",class:m(["form-control",{"is-invalid":t.電子載具}]),placeholder:"請輸入  '/'  開頭的載具號碼",rules:"required",modelValue:l.form.user.billNum,"onUpdate:modelValue":s[13]||(s[13]=o=>l.form.user.billNum=o)},null,8,["class","modelValue"]),a(d,{name:"電子載具",class:"invalid-feedback"})])):p("",!0),e("div",il,[cl,Y(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[14]||(s[14]=o=>l.form.message=o)},null,512),[[z,l.form.message]])]),e("div",ml,[a(_,{class:"btn btn-outline-primary",to:"/cart"},{default:F(()=>[fl,i("回上一頁")]),_:1}),ul])]),_:1},8,["onSubmit"])])])])]),a(b)],64)}const pl=L(X,[["render",_l]]);export{pl as default};
