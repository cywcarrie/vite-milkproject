import{_ as A,i as E,l as L,g as f,n as C,r as x,o as n,c as a,b as w,a as t,p as v,x as b,h as I,F as g,q as j,t as c,w as O,S as y,e as V}from"./index-Du64BMPH.js";import{V as S}from"./VueLoading-CR15gkqE.js";import{F as T}from"./FooterComponent-kt9ANu53.js";var F={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb",BASE_URL:"/vite-milkproject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API:k,VITE_APP_PATH:P}=F,R={components:{VueLoading:S,FooterComponent:T},setup(){const l=E("$axios"),h=L(),m=f({user:{}}),e=f(""),r=f(!1);function u(){const i=`${k}api/${P}/order/${e.value}`;r.value=!0,l.get(i).then(s=>{s.data.success&&(m.value=s.data.order)}).catch(s=>{var d,_;const o=((_=(d=s.response)==null?void 0:d.data)==null?void 0:_.message)||"發生錯誤，請稍後再試";y("error",o)}).finally(()=>{r.value=!1})}function p(){const i=`${k}api/${P}/pay/${e.value}`;r.value=!0,l.post(i).then(s=>{s.data.success&&(y("success","付款成功"),u())}).catch(s=>{var d,_;const o=((_=(d=s.response)==null?void 0:d.data)==null?void 0:_.message)||"發生錯誤，請稍後再試";y("error",o)}).finally(()=>{r.value=!1})}return C(()=>{e.value=h.params.orderId,u()}),{order:m,orderId:e,isLoading:r,getOrder:u,payOrder:p}}},N={class:"mb-5"},B={class:"container"},D=t("div",{class:"d-flex justify-content-center align-items-center my-5 position-relative banner banner2 container-fluid"},[t("h2",{class:"position-absolute text-center text-white fw-bolder banner-title"},"結帳流程")],-1),M={class:"d-flex justify-content-center align-items-center mb-5 mt-3"},q=t("h5",{class:"d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"},[t("i",{class:"bi bi-1-circle mb-1"}),t("span",null,"填寫資料")],-1),H=t("i",{class:"bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"},null,-1),U=t("i",{class:"bi bi-2-circle mb-1"},null,-1),z=t("span",null,"確認訂單",-1),G=[U,z],J=t("i",{class:"bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"},null,-1),K=t("i",{class:"bi bi-3-circle mb-1"},null,-1),Q=t("span",null,"訂單完成",-1),W=[K,Q],X={class:"row justify-content-center align-items-center"},Y={class:"col-md-10"},Z={key:0,class:"d-flex justify-content-center align-items-center mt-5"},$=t("i",{class:"bi bi-bag-check-fill fs-2 pe-2 text-success"},null,-1),tt=t("h2",{class:"fw-bold mb-0 text-success"},"訂購成功 !",-1),et=[$,tt],st={key:1,class:"fw-bold mt-4 mb-5 text-center"},ot={class:"my-5 row justify-content-center"},nt=t("h3",{class:"text-center fw-bold mb-4"},"訂單明細",-1),at={class:"table align-middle table-light table-borderless mb-4"},ct=t("thead",{class:"text-center"},[t("tr",null,[t("th",{class:"text-nowrap"},"商品名稱"),t("th",{class:"text-center text-nowrap"},"數量"),t("th",{class:"text-nowrap"},"價格")])],-1),rt={class:"text-center"},lt={class:"text-center text-nowrap"},it={class:"text-center text-nowrap"},dt=t("td",{colspan:"2",class:"text-end text-nowrap"},"總計",-1),_t={class:"fs-5 text-primary fw-bold text-nowrap"},ht=t("h3",{class:"text-center fw-bold mb-4"},"訂購人資訊",-1),ut={class:"table table-light table-borderless mb-4"},bt={class:"table-nowrap"},mt=t("th",{class:"text-nowrap"},"姓名",-1),pt={class:"text-nowrap"},ft={class:"table-nowrap"},xt=t("th",{width:"100",class:"text-nowrap"},"Email",-1),wt={class:"text-nowrap"},yt={class:"table-nowrap"},vt=t("th",{class:"text-nowrap"},"電話",-1),gt={class:"text-nowrap"},kt={class:"table-nowrap"},Pt=t("th",{class:"text-nowrap"},"付款方式",-1),Vt={class:"text-nowrap"},At={class:"table-nowrap"},Et=t("th",null,"訂購狀態",-1),Lt={key:0,class:"text-nowrap text-danger fw-bold"},Ct={key:1,class:"text-success fw-bold text-nowrap"},It={key:0,class:"text-end"},jt=t("button",{class:"btn btn-primary ms-auto",type:"submit"},[V(" 確認訂購"),t("i",{class:"bi bi-caret-right-fill"})],-1),Ot=[jt],St={key:1,class:"text-end"},Tt=t("i",{class:"bi bi-cart4 pe-1 fs-5"},null,-1);function Ft(l,h,m,e,r,u){const p=x("VueLoading"),i=x("RouterLink"),s=x("FooterComponent");return n(),a(g,null,[w(p,{active:e.isLoading},null,8,["active"]),t("section",N,[t("div",B,[D,t("div",M,[q,H,t("h5",{class:v(["d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header",{active:e.order.is_paid===!1}])},G,2),J,t("h5",{class:v(["d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header",{active:e.order.is_paid===!0}])},W,2)]),t("div",X,[t("div",Y,[e.order.is_paid===!0?(n(),a("div",Z,et)):b("",!0),e.order.is_paid===!0?(n(),a("h6",st," 感謝您的訂購，訂單明細將會寄送至您的電子信箱 ! ")):b("",!0),t("div",ot,[nt,t("form",{class:"col-lg-6",onSubmit:h[0]||(h[0]=I((...o)=>e.payOrder&&e.payOrder(...o),["prevent"]))},[t("table",at,[ct,t("tbody",null,[(n(!0),a(g,null,j(e.order.products,o=>(n(),a("tr",{key:o.id},[t("td",rt,c(o.product.title),1),t("td",lt,c(o.qty),1),t("td",it,c(l.$format.currency(o.final_total)),1)]))),128))]),t("tfoot",null,[t("tr",null,[dt,t("td",_t,c(l.$format.currency(e.order.total)),1)])])]),ht,t("table",ut,[t("tbody",null,[t("tr",bt,[mt,t("td",pt,c(e.order.user.name),1)]),t("tr",ft,[xt,t("td",wt,c(e.order.user.email),1)]),t("tr",yt,[vt,t("td",gt,c(e.order.user.tel),1)]),t("tr",kt,[Pt,t("td",Vt,c(e.order.user.pay),1)]),t("tr",At,[Et,t("td",null,[e.order.is_paid?(n(),a("span",Ct,"訂購完成")):(n(),a("span",Lt,"尚未訂購"))])])])]),e.order.is_paid===!1?(n(),a("div",It,Ot)):b("",!0),e.order.is_paid===!0?(n(),a("div",St,[w(i,{to:"/products",class:"btn btn-primary ms-auto"},{default:O(()=>[Tt,V("繼續選購")]),_:1})])):b("",!0)],32)])])])])]),w(s)],64)}const Dt=A(R,[["render",Ft]]);export{Dt as default};
