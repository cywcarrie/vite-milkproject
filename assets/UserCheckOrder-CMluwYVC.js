import{_ as C,i as I,l as O,u as R,g as x,n as S,r as y,o,c as n,b as v,a as t,p as P,h as T,x as b,F as V,q as j,t as a,w as F,S as w,e as m}from"./index-CLkijdjE.js";import{V as N}from"./VueLoading-BfULdMT8.js";import{F as B}from"./FooterComponent-BM-pjMQv.js";var D={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb",BASE_URL:"/vite-milkproject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API:A,VITE_APP_PATH:E}=D,M={components:{VueLoading:N,FooterComponent:B},setup(){const l=I("$axios"),h=O(),f=R(),e=x({user:{}}),r=x(""),c=x(!1);function d(){const i=`${A}api/${E}/order/${r.value}`;c.value=!0,l.get(i).then(s=>{s.data.success&&(e.value=s.data.order)}).catch(s=>{var _,u,k;if(((_=s.response)==null?void 0:_.status)===404)f.push("/not-found");else{const L=((k=(u=s.response)==null?void 0:u.data)==null?void 0:k.message)||"發生錯誤，請稍後再試";w("error",L)}}).finally(()=>{c.value=!1})}function p(){const i=`${A}api/${E}/pay/${r.value}`;c.value=!0,l.post(i).then(s=>{s.data.success&&(w("success","付款成功"),d())}).catch(s=>{var _,u;const g=((u=(_=s.response)==null?void 0:_.data)==null?void 0:u.message)||"發生錯誤，請稍後再試";w("error",g)}).finally(()=>{c.value=!1})}return S(()=>{if(r.value=h.params.orderId,!r.value){f.push("/not-found");return}d()}),{order:e,orderId:r,isLoading:c,getOrder:d,payOrder:p}}},q={class:"mb-5"},H={class:"container"},U=t("div",{class:"d-flex justify-content-center align-items-center my-5 position-relative banner banner2 container-fluid"},[t("h2",{class:"position-absolute text-center text-white fw-bolder banner-title"},"結帳流程")],-1),z={class:"d-flex justify-content-center align-items-center mb-5 mt-3"},G=t("h5",{class:"d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header"},[t("i",{class:"bi bi-1-circle mb-1"}),t("span",null,"填寫資料")],-1),J=t("i",{class:"bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"},null,-1),K=t("i",{class:"bi bi-2-circle mb-1"},null,-1),Q=t("span",null,"確認訂單",-1),W=[K,Q],X=t("i",{class:"bi bi-caret-right-fill fs-5 mx-1 mx-md-2 text-secondary"},null,-1),Y=t("i",{class:"bi bi-3-circle mb-1"},null,-1),Z=t("span",null,"訂單完成",-1),$=[Y,Z],tt={class:"my-5 row justify-content-center"},et={key:0,class:"d-flex justify-content-center align-items-center mt-5"},st=t("i",{class:"bi bi-bag-check-fill fs-2 pe-2 text-success"},null,-1),ot=t("h2",{class:"fw-bold mb-0 text-success"},"訂購成功 !",-1),nt=[st,ot],at={key:1,class:"fw-bold mt-4 mb-5 text-center"},rt={class:"custom-card shadow-sm p-4 mb-4 bg-white rounded-4 border border-primary"},ct=t("h3",{class:"text-center fw-bold mb-4"},[t("i",{class:"bi bi-receipt-cutoff me-2 text-primary"}),m("訂單明細 ")],-1),lt={class:"table-responsive"},dt={class:"table align-middle table-borderless mb-0"},it=t("thead",{class:"bg-primary text-white text-center rounded-top"},[t("tr",null,[t("th",null,"商品名稱"),t("th",null,"數量"),t("th",{class:"text-nowrap"},"價格")])],-1),_t={class:"text-center"},ut={class:"fw-bold text-body-secondary"},ht={class:"text-body-secondary"},bt={class:"text-nowrap text-body-secondary"},mt=t("td",{colspan:"2",class:"text-end text-nowrap fw-bold"},"總計",-1),ft={class:"fs-5 text-primary fw-bold text-nowrap"},pt={class:"custom-card shadow-sm p-4 mb-4 bg-white rounded-4 border border-secondary"},xt=t("h3",{class:"text-center fw-bold mb-4"},[t("i",{class:"bi bi-person-vcard me-2"}),m("訂購人資訊 ")],-1),yt={class:"table table-borderless mb-0"},vt=t("th",{class:"text-nowrap"},"姓名",-1),wt={class:"text-body-secondary"},gt=t("th",null,"Email",-1),kt={class:"text-body-secondary"},Pt=t("th",{class:"text-start"},"電話",-1),Vt={class:"text-body-secondary"},At=t("th",null,"付款方式",-1),Et={class:"text-body-secondary"},Lt=t("th",null,"訂購狀態",-1),Ct={key:0,class:"text-danger fw-bold"},It={key:1,class:"text-success fw-bold"},Ot={key:2,class:"text-end"},Rt=t("button",{class:"btn btn-primary ms-auto",type:"submit"},[m(" 確認訂購"),t("i",{class:"bi bi-caret-right-fill"})],-1),St=[Rt],Tt={key:3,class:"text-end"},jt=t("i",{class:"bi bi-cart4 pe-1 fs-5"},null,-1);function Ft(l,h,f,e,r,c){const d=y("VueLoading"),p=y("RouterLink"),i=y("FooterComponent");return o(),n(V,null,[v(d,{active:e.isLoading},null,8,["active"]),t("section",q,[t("div",H,[U,t("div",z,[G,J,t("h5",{class:P(["d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header",{active:e.order.is_paid===!1}])},W,2),X,t("h5",{class:P(["d-flex flex-column text-center fw-bold mb-0 text-secondary pay-header",{active:e.order.is_paid===!0}])},$,2)]),t("div",tt,[t("form",{class:"col-lg-6 col-md-8",onSubmit:h[0]||(h[0]=T((...s)=>e.payOrder&&e.payOrder(...s),["prevent"]))},[e.order.is_paid===!0?(o(),n("div",et,nt)):b("",!0),e.order.is_paid===!0?(o(),n("h6",at," 感謝您的訂購，訂單明細將會寄送至您的電子信箱 ! ")):b("",!0),t("div",rt,[ct,t("div",lt,[t("table",dt,[it,t("tbody",_t,[(o(!0),n(V,null,j(e.order.products,s=>(o(),n("tr",{key:s.id},[t("td",ut,a(s.product.title),1),t("td",ht,a(s.qty),1),t("td",bt,a(l.$format.currency(s.final_total)),1)]))),128))]),t("tfoot",null,[t("tr",null,[mt,t("td",ft,a(l.$format.currency(e.order.total)),1)])])])])]),t("div",pt,[xt,t("table",yt,[t("tbody",null,[t("tr",null,[vt,t("td",wt,a(e.order.user.name),1)]),t("tr",null,[gt,t("td",kt,a(e.order.user.email),1)]),t("tr",null,[Pt,t("td",Vt,a(e.order.user.tel),1)]),t("tr",null,[At,t("td",Et,a(e.order.user.pay),1)]),t("tr",null,[Lt,t("td",null,[e.order.is_paid?(o(),n("span",It,"訂購完成")):(o(),n("span",Ct,"尚未訂購"))])])])])]),e.order.is_paid===!1?(o(),n("div",Ot,St)):b("",!0),e.order.is_paid===!0?(o(),n("div",Tt,[v(p,{to:"/products",class:"btn btn-primary ms-auto"},{default:F(()=>[jt,m("繼續選購")]),_:1})])):b("",!0)],32)])])]),v(i)],64)}const Mt=C(M,[["render",Ft]]);export{Mt as default};
